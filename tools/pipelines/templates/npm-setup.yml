parameters:
  installCypress: 0
  YARN_CACHE_FOLDER: $(Pipeline.Workspace)/.yarn
steps:
  - task: Cache@2
    inputs:
      key: yarn | $(Agent.OS) | yarn.lock
      restoreKeys: |
      yarn | $(Agent.OS)
      yarn
      path: $(YARN_CACHE_FOLDER)
    displayName: Cache Yarn packages

  - task: Cache@2
    inputs:
      key: cypress | $(Agent.OS) | yarn.lock
      path: /home/vsts/.cache/Cypress
      restoreKeys: cypress | $(Agent.OS) | yarn.lock
    displayName: Cache Cypress binary

  # Install Node dependencies
  # TODO: support no cypress install and ignore scripts --ignore-scripts
  - script: yarn --frozen-lockfile
    displayName: 'Install NPM dependencies'
